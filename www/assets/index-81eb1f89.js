import{r as n,s as o,v as r}from"./api-9463a482.js";import{n as l,d as c,l as d}from"./index-20699720.js";var u=function(){var s=this,i=s.$createElement,e=s._self._c||i;return e("div",[e("t-card",{staticClass:"list-card-container",attrs:{bordered:""}},[e("t-form",{ref:"userFrom",staticStyle:{"margin-top":"16px","margin-bottom":"32px"},attrs:{labelWidth:"200px"}},[e("t-form-item",{key:"currnet_device_ip",staticStyle:{width:"1200px"},attrs:{label:"登录IP"}},[e("t-input",{attrs:{type:"text",readonly:""},on:{click:function(t){return s.on_redirect_ipdb(s.session.client_ip)}},model:{value:s.session.client_ip,callback:function(t){s.$set(s.session,"client_ip",t)},expression:"session.client_ip"}})],1),e("t-form-item",{key:"currnet_login_device",staticStyle:{width:"1200px"},attrs:{label:"本次登录设备"}},[e("t-input",{attrs:{type:"text",readonly:""},model:{value:s.session.user_agent,callback:function(t){s.$set(s.session,"user_agent",t)},expression:"session.user_agent"}})],1),e("t-form-item",{key:"currnet_login_time",staticStyle:{width:"1200px"},attrs:{label:"登录时间"}},[e("t-input",{attrs:{type:"text",readonly:""},model:{value:s.session.login_time,callback:function(t){s.$set(s.session,"login_time",t)},expression:"session.login_time"}})],1),e("t-form-item",{key:"user_nickname",staticStyle:{width:"600px"},attrs:{label:"昵称"}},[e("t-input",{attrs:{type:"text"},model:{value:s.session.nickname,callback:function(t){s.$set(s.session,"nickname",t)},expression:"session.nickname"}}),e("t-button",{staticStyle:{"margin-left":"16px"},attrs:{theme:"default",variant:"outline"},on:{click:function(t){return s.on_edit_user()}}},[s._v("保存")])],1),e("t-form-item",{key:"user_mail_address",staticStyle:{width:"600px"},attrs:{label:"邮箱地址"}},[e("t-input",{attrs:{type:"text"},model:{value:s.session.mail_address,callback:function(t){s.$set(s.session,"mail_address",t)},expression:"session.mail_address"}}),e("t-button",{staticStyle:{"margin-left":"16px"},attrs:{theme:"default",variant:"outline"}},[s._v("保存")])],1),e("t-form-item",{key:"user_password_old",staticStyle:{width:"412px"},attrs:{label:"原密码"}},[e("t-input",{attrs:{type:"password"},model:{value:s.password.old,callback:function(t){s.$set(s.password,"old",t)},expression:"password.old"}})],1),e("t-form-item",{key:"user_password_new",staticStyle:{width:"500px"},attrs:{label:"新密码"}},[e("t-input",{attrs:{type:"password"},model:{value:s.password.new,callback:function(t){s.$set(s.password,"new",t)},expression:"password.new"}}),e("t-button",{staticStyle:{"margin-left":"16px"},attrs:{theme:"default",variant:"outline"},on:{click:function(t){return s.on_update_password()}}},[s._v("修改密码")])],1)],1)],1)],1)},p=[];const _={data(){return{session:{client_ip:"",nickname:"",user_agent:"",mail_address:"",login_time:""},password:{old:"",new:""}}},mounted(){this.query_user_session()},methods:{async query_user_session(){const s=await n();this.session=s.data;const i=c(this.session.login_time).format("YYYY-MM-DD HH:mm:ss");this.session.login_time=i},on_redirect_ipdb(s){d.info("查询ip 地址信息..."),window.open(`https://tools.iw3c.com.cn/ip/?ip=${s}`)},async on_update_password(){if(this.password.new.length<8)this.$message.error("新密码的长度不能小于8位");else if(this.password.old.length<8)this.$message.error("旧密码的长度不能小于8位");else{const s={old_password:this.password.old,new_password:this.password.new};(await o(s)).code===0&&(this.$message.success("重置密码成功,请重新登录"),window.localStorage.removeItem("user_session"),window.localStorage.removeItem("user_session_id"),this.$router.push({path:"/login"}))}},async on_edit_user(){const s={mail_address:this.session.mail_address,nickname:this.session.nickname};if((await r(s)).code===0){this.$message.success("操作成功");const e=await n();window.localStorage.setItem("user_session",JSON.stringify(e.data)),this.query_user_session()}}}},a={};var m=l(_,u,p,!1,w,null,null,null);function w(s){for(let i in a)this[i]=a[i]}const h=function(){return m.exports}();export{h as default};
